language: c
sudo: required
services:
  - docker
cache:
  directories:
    - "$HOME/google-cloud-sdk/"
env:
  - PATH=$PATH:${HOME}/google-cloud-sdk/bin CLOUDSDK_CORE_DISABLE_PROMPTS=1
before_install:
  - |
    if [ ! -d ${HOME}/google-cloud-sdk ]; then
      curl https://sdk.cloud.google.com | bash;
    fi
  - openssl aes-256-cbc -K $encrypted_8a0dc7e65d70_key -iv $encrypted_8a0dc7e65d70_iv -in gcp-travisci.json.enc -out gcp-travisci.json -d
  - gcloud auth activate-service-account travisci@project-kel.iam.gserviceaccount.com --key-file gcp-travisci.json
install:
  - gcloud config set project projectkel
before_script:
  - docker pull quay.io/kelproject/gb-build
script:
  - docker run -i --volume "$(pwd):/src" quay.io/kelproject/gb-build
